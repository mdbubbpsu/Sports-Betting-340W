{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 224,
   "id": "employed-nirvana",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 225,
   "id": "certain-manhattan",
   "metadata": {},
   "outputs": [],
   "source": [
    "games = pd.read_csv(\n",
    "        '/Users/mattbubb/Spring_2021/DS_340W/Sports-Betting-340W/Data/nba_games_all.csv')\n",
    "game = pd.read_csv(\n",
    "        '/Users/mattbubb/Spring_2021/DS_340W/Sports-Betting-340W/Data/nba_games_all.csv', parse_dates = ['game_date'])\n",
    "# Sort immediately \n",
    "games = games.sort_values('game_date').dropna().reset_index().drop('index', axis = 1)\n",
    "game = game.sort_values('game_date').dropna().reset_index().drop('index', axis = 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 226,
   "id": "descending-combat",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Grab date\n",
    "games[['Year', 'Month', 'Day']] = games['game_date'].str.split('-', 2, expand = True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 227,
   "id": "irish-channels",
   "metadata": {},
   "outputs": [],
   "source": [
    "teams = pd.read_csv(\n",
    "        '/Users/mattbubb/Spring_2021/DS_340W/Sports-Betting-340W/Data/nba_teams_all.csv')\n",
    "teams = teams.dropna().drop(['league_id','min_year', 'max_year'],axis =1)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 228,
   "id": "painted-meeting",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>game_id</th>\n",
       "      <th>game_date</th>\n",
       "      <th>matchup</th>\n",
       "      <th>team_id</th>\n",
       "      <th>is_home</th>\n",
       "      <th>wl</th>\n",
       "      <th>w</th>\n",
       "      <th>l</th>\n",
       "      <th>w_pct</th>\n",
       "      <th>min</th>\n",
       "      <th>...</th>\n",
       "      <th>pf</th>\n",
       "      <th>pts</th>\n",
       "      <th>a_team_id</th>\n",
       "      <th>season_year</th>\n",
       "      <th>season_type</th>\n",
       "      <th>season</th>\n",
       "      <th>Year</th>\n",
       "      <th>Month</th>\n",
       "      <th>Day</th>\n",
       "      <th>abbreviation</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>29600021</td>\n",
       "      <td>1996-11-02</td>\n",
       "      <td>DAL vs. SAC</td>\n",
       "      <td>1610612758</td>\n",
       "      <td>f</td>\n",
       "      <td>W</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.500</td>\n",
       "      <td>240</td>\n",
       "      <td>...</td>\n",
       "      <td>25.0</td>\n",
       "      <td>107</td>\n",
       "      <td>1610612742</td>\n",
       "      <td>1996</td>\n",
       "      <td>Regular Season</td>\n",
       "      <td>1996-97</td>\n",
       "      <td>1996</td>\n",
       "      <td>11</td>\n",
       "      <td>02</td>\n",
       "      <td>SAC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>40000007</td>\n",
       "      <td>2001-04-22</td>\n",
       "      <td>PHX @ SAC</td>\n",
       "      <td>1610612758</td>\n",
       "      <td>t</td>\n",
       "      <td>L</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.000</td>\n",
       "      <td>240</td>\n",
       "      <td>...</td>\n",
       "      <td>16.0</td>\n",
       "      <td>83</td>\n",
       "      <td>1610612756</td>\n",
       "      <td>2000</td>\n",
       "      <td>Playoffs</td>\n",
       "      <td>2000-01</td>\n",
       "      <td>2001</td>\n",
       "      <td>04</td>\n",
       "      <td>22</td>\n",
       "      <td>SAC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>40000014</td>\n",
       "      <td>2001-04-25</td>\n",
       "      <td>PHX @ SAC</td>\n",
       "      <td>1610612758</td>\n",
       "      <td>t</td>\n",
       "      <td>W</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.500</td>\n",
       "      <td>240</td>\n",
       "      <td>...</td>\n",
       "      <td>20.0</td>\n",
       "      <td>116</td>\n",
       "      <td>1610612756</td>\n",
       "      <td>2000</td>\n",
       "      <td>Playoffs</td>\n",
       "      <td>2000-01</td>\n",
       "      <td>2001</td>\n",
       "      <td>04</td>\n",
       "      <td>25</td>\n",
       "      <td>SAC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>40000023</td>\n",
       "      <td>2001-04-29</td>\n",
       "      <td>PHX vs. SAC</td>\n",
       "      <td>1610612758</td>\n",
       "      <td>f</td>\n",
       "      <td>W</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.667</td>\n",
       "      <td>240</td>\n",
       "      <td>...</td>\n",
       "      <td>26.0</td>\n",
       "      <td>104</td>\n",
       "      <td>1610612756</td>\n",
       "      <td>2000</td>\n",
       "      <td>Playoffs</td>\n",
       "      <td>2000-01</td>\n",
       "      <td>2001</td>\n",
       "      <td>04</td>\n",
       "      <td>29</td>\n",
       "      <td>SAC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>40000030</td>\n",
       "      <td>2001-05-02</td>\n",
       "      <td>PHX vs. SAC</td>\n",
       "      <td>1610612758</td>\n",
       "      <td>f</td>\n",
       "      <td>W</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.750</td>\n",
       "      <td>240</td>\n",
       "      <td>...</td>\n",
       "      <td>23.0</td>\n",
       "      <td>89</td>\n",
       "      <td>1610612756</td>\n",
       "      <td>2000</td>\n",
       "      <td>Playoffs</td>\n",
       "      <td>2000-01</td>\n",
       "      <td>2001</td>\n",
       "      <td>05</td>\n",
       "      <td>02</td>\n",
       "      <td>SAC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37699</th>\n",
       "      <td>21701168</td>\n",
       "      <td>2018-04-03</td>\n",
       "      <td>SAS @ LAC</td>\n",
       "      <td>1610612746</td>\n",
       "      <td>t</td>\n",
       "      <td>W</td>\n",
       "      <td>42.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>0.538</td>\n",
       "      <td>240</td>\n",
       "      <td>...</td>\n",
       "      <td>23.0</td>\n",
       "      <td>113</td>\n",
       "      <td>1610612759</td>\n",
       "      <td>2017</td>\n",
       "      <td>Regular Season</td>\n",
       "      <td>2017-18</td>\n",
       "      <td>2018</td>\n",
       "      <td>04</td>\n",
       "      <td>03</td>\n",
       "      <td>LAC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37700</th>\n",
       "      <td>21701179</td>\n",
       "      <td>2018-04-05</td>\n",
       "      <td>UTA vs. LAC</td>\n",
       "      <td>1610612746</td>\n",
       "      <td>f</td>\n",
       "      <td>L</td>\n",
       "      <td>42.0</td>\n",
       "      <td>37.0</td>\n",
       "      <td>0.532</td>\n",
       "      <td>240</td>\n",
       "      <td>...</td>\n",
       "      <td>25.0</td>\n",
       "      <td>95</td>\n",
       "      <td>1610612762</td>\n",
       "      <td>2017</td>\n",
       "      <td>Regular Season</td>\n",
       "      <td>2017-18</td>\n",
       "      <td>2018</td>\n",
       "      <td>04</td>\n",
       "      <td>05</td>\n",
       "      <td>LAC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37701</th>\n",
       "      <td>21701191</td>\n",
       "      <td>2018-04-07</td>\n",
       "      <td>DEN @ LAC</td>\n",
       "      <td>1610612746</td>\n",
       "      <td>t</td>\n",
       "      <td>L</td>\n",
       "      <td>42.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>0.525</td>\n",
       "      <td>240</td>\n",
       "      <td>...</td>\n",
       "      <td>19.0</td>\n",
       "      <td>115</td>\n",
       "      <td>1610612743</td>\n",
       "      <td>2017</td>\n",
       "      <td>Regular Season</td>\n",
       "      <td>2017-18</td>\n",
       "      <td>2018</td>\n",
       "      <td>04</td>\n",
       "      <td>07</td>\n",
       "      <td>LAC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37702</th>\n",
       "      <td>21701212</td>\n",
       "      <td>2018-04-09</td>\n",
       "      <td>NOP @ LAC</td>\n",
       "      <td>1610612746</td>\n",
       "      <td>t</td>\n",
       "      <td>L</td>\n",
       "      <td>42.0</td>\n",
       "      <td>39.0</td>\n",
       "      <td>0.519</td>\n",
       "      <td>240</td>\n",
       "      <td>...</td>\n",
       "      <td>18.0</td>\n",
       "      <td>100</td>\n",
       "      <td>1610612740</td>\n",
       "      <td>2017</td>\n",
       "      <td>Regular Season</td>\n",
       "      <td>2017-18</td>\n",
       "      <td>2018</td>\n",
       "      <td>04</td>\n",
       "      <td>09</td>\n",
       "      <td>LAC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37703</th>\n",
       "      <td>21701228</td>\n",
       "      <td>2018-04-11</td>\n",
       "      <td>LAL @ LAC</td>\n",
       "      <td>1610612746</td>\n",
       "      <td>t</td>\n",
       "      <td>L</td>\n",
       "      <td>42.0</td>\n",
       "      <td>40.0</td>\n",
       "      <td>0.512</td>\n",
       "      <td>240</td>\n",
       "      <td>...</td>\n",
       "      <td>17.0</td>\n",
       "      <td>100</td>\n",
       "      <td>1610612747</td>\n",
       "      <td>2017</td>\n",
       "      <td>Regular Season</td>\n",
       "      <td>2017-18</td>\n",
       "      <td>2018</td>\n",
       "      <td>04</td>\n",
       "      <td>11</td>\n",
       "      <td>LAC</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>37704 rows × 36 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        game_id   game_date      matchup     team_id is_home wl     w     l  \\\n",
       "0      29600021  1996-11-02  DAL vs. SAC  1610612758       f  W   1.0   1.0   \n",
       "1      40000007  2001-04-22    PHX @ SAC  1610612758       t  L   0.0   1.0   \n",
       "2      40000014  2001-04-25    PHX @ SAC  1610612758       t  W   1.0   1.0   \n",
       "3      40000023  2001-04-29  PHX vs. SAC  1610612758       f  W   2.0   1.0   \n",
       "4      40000030  2001-05-02  PHX vs. SAC  1610612758       f  W   3.0   1.0   \n",
       "...         ...         ...          ...         ...     ... ..   ...   ...   \n",
       "37699  21701168  2018-04-03    SAS @ LAC  1610612746       t  W  42.0  36.0   \n",
       "37700  21701179  2018-04-05  UTA vs. LAC  1610612746       f  L  42.0  37.0   \n",
       "37701  21701191  2018-04-07    DEN @ LAC  1610612746       t  L  42.0  38.0   \n",
       "37702  21701212  2018-04-09    NOP @ LAC  1610612746       t  L  42.0  39.0   \n",
       "37703  21701228  2018-04-11    LAL @ LAC  1610612746       t  L  42.0  40.0   \n",
       "\n",
       "       w_pct  min  ...    pf  pts   a_team_id  season_year     season_type  \\\n",
       "0      0.500  240  ...  25.0  107  1610612742         1996  Regular Season   \n",
       "1      0.000  240  ...  16.0   83  1610612756         2000        Playoffs   \n",
       "2      0.500  240  ...  20.0  116  1610612756         2000        Playoffs   \n",
       "3      0.667  240  ...  26.0  104  1610612756         2000        Playoffs   \n",
       "4      0.750  240  ...  23.0   89  1610612756         2000        Playoffs   \n",
       "...      ...  ...  ...   ...  ...         ...          ...             ...   \n",
       "37699  0.538  240  ...  23.0  113  1610612759         2017  Regular Season   \n",
       "37700  0.532  240  ...  25.0   95  1610612762         2017  Regular Season   \n",
       "37701  0.525  240  ...  19.0  115  1610612743         2017  Regular Season   \n",
       "37702  0.519  240  ...  18.0  100  1610612740         2017  Regular Season   \n",
       "37703  0.512  240  ...  17.0  100  1610612747         2017  Regular Season   \n",
       "\n",
       "        season  Year  Month  Day  abbreviation  \n",
       "0      1996-97  1996     11   02           SAC  \n",
       "1      2000-01  2001     04   22           SAC  \n",
       "2      2000-01  2001     04   25           SAC  \n",
       "3      2000-01  2001     04   29           SAC  \n",
       "4      2000-01  2001     05   02           SAC  \n",
       "...        ...   ...    ...  ...           ...  \n",
       "37699  2017-18  2018     04   03           LAC  \n",
       "37700  2017-18  2018     04   05           LAC  \n",
       "37701  2017-18  2018     04   07           LAC  \n",
       "37702  2017-18  2018     04   09           LAC  \n",
       "37703  2017-18  2018     04   11           LAC  \n",
       "\n",
       "[37704 rows x 36 columns]"
      ]
     },
     "execution_count": 228,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "games = games.merge(teams, on = 'team_id')\n",
    "game = game.merge(teams, on = 'team_id')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 230,
   "id": "regional-humor",
   "metadata": {},
   "outputs": [],
   "source": [
    "game.set_index('game_date', inplace= True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 240,
   "id": "connected-protest",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>game_id</th>\n",
       "      <th>team_id</th>\n",
       "      <th>w</th>\n",
       "      <th>l</th>\n",
       "      <th>w_pct</th>\n",
       "      <th>min</th>\n",
       "      <th>fgm</th>\n",
       "      <th>fga</th>\n",
       "      <th>fg_pct</th>\n",
       "      <th>fg3m</th>\n",
       "      <th>...</th>\n",
       "      <th>dreb</th>\n",
       "      <th>reb</th>\n",
       "      <th>ast</th>\n",
       "      <th>stl</th>\n",
       "      <th>blk</th>\n",
       "      <th>tov</th>\n",
       "      <th>pf</th>\n",
       "      <th>pts</th>\n",
       "      <th>a_team_id</th>\n",
       "      <th>season_year</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>abbreviation</th>\n",
       "      <th>game_date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">ATL</th>\n",
       "      <th>2003-11-02</th>\n",
       "      <td>20300029</td>\n",
       "      <td>1610612737</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.000</td>\n",
       "      <td>265</td>\n",
       "      <td>36.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>0.468</td>\n",
       "      <td>6.0</td>\n",
       "      <td>...</td>\n",
       "      <td>32.0</td>\n",
       "      <td>36</td>\n",
       "      <td>23.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>99</td>\n",
       "      <td>1610612754</td>\n",
       "      <td>2003</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2003-11-09</th>\n",
       "      <td>81200275</td>\n",
       "      <td>6442450948</td>\n",
       "      <td>5.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>0.903</td>\n",
       "      <td>960</td>\n",
       "      <td>133.0</td>\n",
       "      <td>312.0</td>\n",
       "      <td>1.711</td>\n",
       "      <td>19.0</td>\n",
       "      <td>...</td>\n",
       "      <td>127.0</td>\n",
       "      <td>179</td>\n",
       "      <td>76.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>69.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>336</td>\n",
       "      <td>6442451001</td>\n",
       "      <td>8012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2003-11-16</th>\n",
       "      <td>60900339</td>\n",
       "      <td>4831838211</td>\n",
       "      <td>8.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0.883</td>\n",
       "      <td>720</td>\n",
       "      <td>104.0</td>\n",
       "      <td>227.0</td>\n",
       "      <td>1.382</td>\n",
       "      <td>21.0</td>\n",
       "      <td>...</td>\n",
       "      <td>83.0</td>\n",
       "      <td>113</td>\n",
       "      <td>63.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>287</td>\n",
       "      <td>4831838253</td>\n",
       "      <td>6009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2003-11-23</th>\n",
       "      <td>81200633</td>\n",
       "      <td>6442450948</td>\n",
       "      <td>16.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>1.271</td>\n",
       "      <td>960</td>\n",
       "      <td>133.0</td>\n",
       "      <td>319.0</td>\n",
       "      <td>1.666</td>\n",
       "      <td>10.0</td>\n",
       "      <td>...</td>\n",
       "      <td>123.0</td>\n",
       "      <td>173</td>\n",
       "      <td>70.0</td>\n",
       "      <td>33.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>68.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>365</td>\n",
       "      <td>6442451011</td>\n",
       "      <td>8012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2003-11-30</th>\n",
       "      <td>81200828</td>\n",
       "      <td>6442450948</td>\n",
       "      <td>22.0</td>\n",
       "      <td>44.0</td>\n",
       "      <td>1.332</td>\n",
       "      <td>985</td>\n",
       "      <td>138.0</td>\n",
       "      <td>316.0</td>\n",
       "      <td>1.745</td>\n",
       "      <td>15.0</td>\n",
       "      <td>...</td>\n",
       "      <td>130.0</td>\n",
       "      <td>179</td>\n",
       "      <td>84.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>82.0</td>\n",
       "      <td>367</td>\n",
       "      <td>6442451029</td>\n",
       "      <td>8012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">WAS</th>\n",
       "      <th>2018-04-01</th>\n",
       "      <td>86804514</td>\n",
       "      <td>6442451056</td>\n",
       "      <td>166.0</td>\n",
       "      <td>136.0</td>\n",
       "      <td>2.199</td>\n",
       "      <td>960</td>\n",
       "      <td>160.0</td>\n",
       "      <td>343.0</td>\n",
       "      <td>1.869</td>\n",
       "      <td>42.0</td>\n",
       "      <td>...</td>\n",
       "      <td>135.0</td>\n",
       "      <td>174</td>\n",
       "      <td>118.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>81.0</td>\n",
       "      <td>409</td>\n",
       "      <td>6442451031</td>\n",
       "      <td>8068</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-04-08</th>\n",
       "      <td>65103521</td>\n",
       "      <td>4831838292</td>\n",
       "      <td>126.0</td>\n",
       "      <td>111.0</td>\n",
       "      <td>1.595</td>\n",
       "      <td>720</td>\n",
       "      <td>120.0</td>\n",
       "      <td>253.0</td>\n",
       "      <td>1.430</td>\n",
       "      <td>30.0</td>\n",
       "      <td>...</td>\n",
       "      <td>98.0</td>\n",
       "      <td>122</td>\n",
       "      <td>77.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>44.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>316</td>\n",
       "      <td>4831838221</td>\n",
       "      <td>6051</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-04-15</th>\n",
       "      <td>85102538</td>\n",
       "      <td>4831838292</td>\n",
       "      <td>86.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>1.055</td>\n",
       "      <td>720</td>\n",
       "      <td>115.0</td>\n",
       "      <td>264.0</td>\n",
       "      <td>1.318</td>\n",
       "      <td>33.0</td>\n",
       "      <td>...</td>\n",
       "      <td>102.0</td>\n",
       "      <td>136</td>\n",
       "      <td>78.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>45.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>311</td>\n",
       "      <td>4831838252</td>\n",
       "      <td>6051</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-04-22</th>\n",
       "      <td>125100309</td>\n",
       "      <td>4831838292</td>\n",
       "      <td>3.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.833</td>\n",
       "      <td>720</td>\n",
       "      <td>128.0</td>\n",
       "      <td>256.0</td>\n",
       "      <td>1.500</td>\n",
       "      <td>27.0</td>\n",
       "      <td>...</td>\n",
       "      <td>93.0</td>\n",
       "      <td>113</td>\n",
       "      <td>78.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>68.0</td>\n",
       "      <td>347</td>\n",
       "      <td>4831838283</td>\n",
       "      <td>6051</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-04-29</th>\n",
       "      <td>83400211</td>\n",
       "      <td>3221225528</td>\n",
       "      <td>4.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.733</td>\n",
       "      <td>480</td>\n",
       "      <td>69.0</td>\n",
       "      <td>169.0</td>\n",
       "      <td>0.816</td>\n",
       "      <td>13.0</td>\n",
       "      <td>...</td>\n",
       "      <td>67.0</td>\n",
       "      <td>92</td>\n",
       "      <td>33.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>37.0</td>\n",
       "      <td>190</td>\n",
       "      <td>3221225522</td>\n",
       "      <td>4034</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>26239 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                           game_id     team_id      w      l  w_pct  min  \\\n",
       "abbreviation game_date                                                     \n",
       "ATL          2003-11-02   20300029  1610612737    0.0    3.0  0.000  265   \n",
       "             2003-11-09   81200275  6442450948    5.0   17.0  0.903  960   \n",
       "             2003-11-16   60900339  4831838211    8.0   19.0  0.883  720   \n",
       "             2003-11-23   81200633  6442450948   16.0   34.0  1.271  960   \n",
       "             2003-11-30   81200828  6442450948   22.0   44.0  1.332  985   \n",
       "...                            ...         ...    ...    ...    ...  ...   \n",
       "WAS          2018-04-01   86804514  6442451056  166.0  136.0  2.199  960   \n",
       "             2018-04-08   65103521  4831838292  126.0  111.0  1.595  720   \n",
       "             2018-04-15   85102538  4831838292   86.0   78.0  1.055  720   \n",
       "             2018-04-22  125100309  4831838292    3.0    6.0  0.833  720   \n",
       "             2018-04-29   83400211  3221225528    4.0    7.0  0.733  480   \n",
       "\n",
       "                           fgm    fga  fg_pct  fg3m  ...   dreb  reb    ast  \\\n",
       "abbreviation game_date                               ...                      \n",
       "ATL          2003-11-02   36.0   77.0   0.468   6.0  ...   32.0   36   23.0   \n",
       "             2003-11-09  133.0  312.0   1.711  19.0  ...  127.0  179   76.0   \n",
       "             2003-11-16  104.0  227.0   1.382  21.0  ...   83.0  113   63.0   \n",
       "             2003-11-23  133.0  319.0   1.666  10.0  ...  123.0  173   70.0   \n",
       "             2003-11-30  138.0  316.0   1.745  15.0  ...  130.0  179   84.0   \n",
       "...                        ...    ...     ...   ...  ...    ...  ...    ...   \n",
       "WAS          2018-04-01  160.0  343.0   1.869  42.0  ...  135.0  174  118.0   \n",
       "             2018-04-08  120.0  253.0   1.430  30.0  ...   98.0  122   77.0   \n",
       "             2018-04-15  115.0  264.0   1.318  33.0  ...  102.0  136   78.0   \n",
       "             2018-04-22  128.0  256.0   1.500  27.0  ...   93.0  113   78.0   \n",
       "             2018-04-29   69.0  169.0   0.816  13.0  ...   67.0   92   33.0   \n",
       "\n",
       "                          stl   blk   tov    pf  pts   a_team_id  season_year  \n",
       "abbreviation game_date                                                         \n",
       "ATL          2003-11-02   5.0   9.0  16.0  27.0   99  1610612754         2003  \n",
       "             2003-11-09  32.0  25.0  69.0  75.0  336  6442451001         8012  \n",
       "             2003-11-16  19.0  12.0  50.0  65.0  287  4831838253         6009  \n",
       "             2003-11-23  33.0  29.0  68.0  90.0  365  6442451011         8012  \n",
       "             2003-11-30  29.0  22.0  59.0  82.0  367  6442451029         8012  \n",
       "...                       ...   ...   ...   ...  ...         ...          ...  \n",
       "WAS          2018-04-01  30.0  21.0  59.0  81.0  409  6442451031         8068  \n",
       "             2018-04-08  22.0  12.0  44.0  59.0  316  4831838221         6051  \n",
       "             2018-04-15  24.0   7.0  45.0  70.0  311  4831838252         6051  \n",
       "             2018-04-22  27.0  19.0  32.0  68.0  347  4831838283         6051  \n",
       "             2018-04-29   9.0   9.0  29.0  37.0  190  3221225522         4034  \n",
       "\n",
       "[26239 rows x 26 columns]"
      ]
     },
     "execution_count": 240,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "game.groupby('abbreviation').resample('W').sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 229,
   "id": "looking-toyota",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>game_id</th>\n",
       "      <th>team_id</th>\n",
       "      <th>w</th>\n",
       "      <th>l</th>\n",
       "      <th>w_pct</th>\n",
       "      <th>min</th>\n",
       "      <th>fgm</th>\n",
       "      <th>fga</th>\n",
       "      <th>fg_pct</th>\n",
       "      <th>fg3m</th>\n",
       "      <th>...</th>\n",
       "      <th>dreb</th>\n",
       "      <th>reb</th>\n",
       "      <th>ast</th>\n",
       "      <th>stl</th>\n",
       "      <th>blk</th>\n",
       "      <th>tov</th>\n",
       "      <th>pf</th>\n",
       "      <th>pts</th>\n",
       "      <th>a_team_id</th>\n",
       "      <th>season_year</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>abbreviation</th>\n",
       "      <th>season</th>\n",
       "      <th>Month</th>\n",
       "      <th>Day</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">ATL</th>\n",
       "      <th rowspan=\"5\" valign=\"top\">2003-04</th>\n",
       "      <th rowspan=\"5\" valign=\"top\">01</th>\n",
       "      <th>02</th>\n",
       "      <td>20300458</td>\n",
       "      <td>1610612737</td>\n",
       "      <td>9.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>0.265</td>\n",
       "      <td>240</td>\n",
       "      <td>29.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>0.372</td>\n",
       "      <td>3.0</td>\n",
       "      <td>...</td>\n",
       "      <td>24.0</td>\n",
       "      <td>31</td>\n",
       "      <td>22.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>18.0</td>\n",
       "      <td>75</td>\n",
       "      <td>1610612750</td>\n",
       "      <td>2003</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>03</th>\n",
       "      <td>40600929</td>\n",
       "      <td>3221225474</td>\n",
       "      <td>19.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>0.551</td>\n",
       "      <td>480</td>\n",
       "      <td>63.0</td>\n",
       "      <td>159.0</td>\n",
       "      <td>0.792</td>\n",
       "      <td>5.0</td>\n",
       "      <td>...</td>\n",
       "      <td>54.0</td>\n",
       "      <td>78</td>\n",
       "      <td>42.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>159</td>\n",
       "      <td>3221225493</td>\n",
       "      <td>4006</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>06</th>\n",
       "      <td>60901419</td>\n",
       "      <td>4831838211</td>\n",
       "      <td>29.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>0.829</td>\n",
       "      <td>720</td>\n",
       "      <td>99.0</td>\n",
       "      <td>235.0</td>\n",
       "      <td>1.266</td>\n",
       "      <td>6.0</td>\n",
       "      <td>...</td>\n",
       "      <td>85.0</td>\n",
       "      <td>125</td>\n",
       "      <td>61.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>55.0</td>\n",
       "      <td>248</td>\n",
       "      <td>4831838251</td>\n",
       "      <td>6009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>09</th>\n",
       "      <td>81201934</td>\n",
       "      <td>6442450948</td>\n",
       "      <td>39.0</td>\n",
       "      <td>103.0</td>\n",
       "      <td>1.099</td>\n",
       "      <td>960</td>\n",
       "      <td>125.0</td>\n",
       "      <td>300.0</td>\n",
       "      <td>1.666</td>\n",
       "      <td>7.0</td>\n",
       "      <td>...</td>\n",
       "      <td>109.0</td>\n",
       "      <td>154</td>\n",
       "      <td>74.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>67.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>315</td>\n",
       "      <td>6442450998</td>\n",
       "      <td>8012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>101502456</td>\n",
       "      <td>8053063685</td>\n",
       "      <td>49.0</td>\n",
       "      <td>131.0</td>\n",
       "      <td>1.362</td>\n",
       "      <td>1200</td>\n",
       "      <td>151.0</td>\n",
       "      <td>366.0</td>\n",
       "      <td>2.060</td>\n",
       "      <td>8.0</td>\n",
       "      <td>...</td>\n",
       "      <td>138.0</td>\n",
       "      <td>187</td>\n",
       "      <td>88.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>85.0</td>\n",
       "      <td>104.0</td>\n",
       "      <td>386</td>\n",
       "      <td>8053063760</td>\n",
       "      <td>10015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">WAS</th>\n",
       "      <th rowspan=\"5\" valign=\"top\">2017-18</th>\n",
       "      <th rowspan=\"5\" valign=\"top\">12</th>\n",
       "      <th>23</th>\n",
       "      <td>26919046146</td>\n",
       "      <td>1977832474192</td>\n",
       "      <td>21391.0</td>\n",
       "      <td>27780.0</td>\n",
       "      <td>516.003</td>\n",
       "      <td>297145</td>\n",
       "      <td>45818.0</td>\n",
       "      <td>101983.0</td>\n",
       "      <td>552.510</td>\n",
       "      <td>8217.0</td>\n",
       "      <td>...</td>\n",
       "      <td>37600.0</td>\n",
       "      <td>51788</td>\n",
       "      <td>25871.0</td>\n",
       "      <td>9658.0</td>\n",
       "      <td>5800.0</td>\n",
       "      <td>17199.0</td>\n",
       "      <td>26043.0</td>\n",
       "      <td>122097</td>\n",
       "      <td>1977832457752</td>\n",
       "      <td>2468383</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>26940746641</td>\n",
       "      <td>1979443086956</td>\n",
       "      <td>21410.0</td>\n",
       "      <td>27795.0</td>\n",
       "      <td>516.562</td>\n",
       "      <td>297385</td>\n",
       "      <td>45861.0</td>\n",
       "      <td>102076.0</td>\n",
       "      <td>552.972</td>\n",
       "      <td>8223.0</td>\n",
       "      <td>...</td>\n",
       "      <td>37633.0</td>\n",
       "      <td>51835</td>\n",
       "      <td>25897.0</td>\n",
       "      <td>9664.0</td>\n",
       "      <td>5804.0</td>\n",
       "      <td>17207.0</td>\n",
       "      <td>26060.0</td>\n",
       "      <td>122208</td>\n",
       "      <td>1979443070490</td>\n",
       "      <td>2470400</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>26962447149</td>\n",
       "      <td>1981053699720</td>\n",
       "      <td>21429.0</td>\n",
       "      <td>27811.0</td>\n",
       "      <td>517.105</td>\n",
       "      <td>297625</td>\n",
       "      <td>45896.0</td>\n",
       "      <td>102157.0</td>\n",
       "      <td>553.404</td>\n",
       "      <td>8232.0</td>\n",
       "      <td>...</td>\n",
       "      <td>37664.0</td>\n",
       "      <td>51875</td>\n",
       "      <td>25921.0</td>\n",
       "      <td>9670.0</td>\n",
       "      <td>5809.0</td>\n",
       "      <td>17220.0</td>\n",
       "      <td>26084.0</td>\n",
       "      <td>122307</td>\n",
       "      <td>1981053683227</td>\n",
       "      <td>2472417</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>26984147670</td>\n",
       "      <td>1982664312484</td>\n",
       "      <td>21449.0</td>\n",
       "      <td>27827.0</td>\n",
       "      <td>517.661</td>\n",
       "      <td>297865</td>\n",
       "      <td>45943.0</td>\n",
       "      <td>102245.0</td>\n",
       "      <td>553.938</td>\n",
       "      <td>8250.0</td>\n",
       "      <td>...</td>\n",
       "      <td>37699.0</td>\n",
       "      <td>51920</td>\n",
       "      <td>25944.0</td>\n",
       "      <td>9682.0</td>\n",
       "      <td>5814.0</td>\n",
       "      <td>17236.0</td>\n",
       "      <td>26099.0</td>\n",
       "      <td>122428</td>\n",
       "      <td>1982664295972</td>\n",
       "      <td>2474434</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>27005848207</td>\n",
       "      <td>1984274925248</td>\n",
       "      <td>21470.0</td>\n",
       "      <td>27843.0</td>\n",
       "      <td>518.229</td>\n",
       "      <td>298105</td>\n",
       "      <td>45986.0</td>\n",
       "      <td>102338.0</td>\n",
       "      <td>554.400</td>\n",
       "      <td>8266.0</td>\n",
       "      <td>...</td>\n",
       "      <td>37734.0</td>\n",
       "      <td>51967</td>\n",
       "      <td>25971.0</td>\n",
       "      <td>9688.0</td>\n",
       "      <td>5822.0</td>\n",
       "      <td>17246.0</td>\n",
       "      <td>26123.0</td>\n",
       "      <td>122542</td>\n",
       "      <td>1984274908713</td>\n",
       "      <td>2476451</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>37704 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                    game_id        team_id        w        l  \\\n",
       "abbreviation season  Month Day                                                 \n",
       "ATL          2003-04 01    02      20300458     1610612737      9.0     25.0   \n",
       "                           03      40600929     3221225474     19.0     50.0   \n",
       "                           06      60901419     4831838211     29.0     76.0   \n",
       "                           09      81201934     6442450948     39.0    103.0   \n",
       "                           10     101502456     8053063685     49.0    131.0   \n",
       "...                                     ...            ...      ...      ...   \n",
       "WAS          2017-18 12    23   26919046146  1977832474192  21391.0  27780.0   \n",
       "                           25   26940746641  1979443086956  21410.0  27795.0   \n",
       "                           27   26962447149  1981053699720  21429.0  27811.0   \n",
       "                           29   26984147670  1982664312484  21449.0  27827.0   \n",
       "                           31   27005848207  1984274925248  21470.0  27843.0   \n",
       "\n",
       "                                  w_pct     min      fgm       fga   fg_pct  \\\n",
       "abbreviation season  Month Day                                                \n",
       "ATL          2003-04 01    02     0.265     240     29.0      78.0    0.372   \n",
       "                           03     0.551     480     63.0     159.0    0.792   \n",
       "                           06     0.829     720     99.0     235.0    1.266   \n",
       "                           09     1.099     960    125.0     300.0    1.666   \n",
       "                           10     1.362    1200    151.0     366.0    2.060   \n",
       "...                                 ...     ...      ...       ...      ...   \n",
       "WAS          2017-18 12    23   516.003  297145  45818.0  101983.0  552.510   \n",
       "                           25   516.562  297385  45861.0  102076.0  552.972   \n",
       "                           27   517.105  297625  45896.0  102157.0  553.404   \n",
       "                           29   517.661  297865  45943.0  102245.0  553.938   \n",
       "                           31   518.229  298105  45986.0  102338.0  554.400   \n",
       "\n",
       "                                  fg3m  ...     dreb    reb      ast     stl  \\\n",
       "abbreviation season  Month Day          ...                                    \n",
       "ATL          2003-04 01    02      3.0  ...     24.0     31     22.0     3.0   \n",
       "                           03      5.0  ...     54.0     78     42.0     9.0   \n",
       "                           06      6.0  ...     85.0    125     61.0    13.0   \n",
       "                           09      7.0  ...    109.0    154     74.0    19.0   \n",
       "                           10      8.0  ...    138.0    187     88.0    27.0   \n",
       "...                                ...  ...      ...    ...      ...     ...   \n",
       "WAS          2017-18 12    23   8217.0  ...  37600.0  51788  25871.0  9658.0   \n",
       "                           25   8223.0  ...  37633.0  51835  25897.0  9664.0   \n",
       "                           27   8232.0  ...  37664.0  51875  25921.0  9670.0   \n",
       "                           29   8250.0  ...  37699.0  51920  25944.0  9682.0   \n",
       "                           31   8266.0  ...  37734.0  51967  25971.0  9688.0   \n",
       "\n",
       "                                   blk      tov       pf     pts  \\\n",
       "abbreviation season  Month Day                                     \n",
       "ATL          2003-04 01    02      4.0     11.0     18.0      75   \n",
       "                           03      8.0     27.0     36.0     159   \n",
       "                           06     12.0     48.0     55.0     248   \n",
       "                           09     19.0     67.0     75.0     315   \n",
       "                           10     30.0     85.0    104.0     386   \n",
       "...                                ...      ...      ...     ...   \n",
       "WAS          2017-18 12    23   5800.0  17199.0  26043.0  122097   \n",
       "                           25   5804.0  17207.0  26060.0  122208   \n",
       "                           27   5809.0  17220.0  26084.0  122307   \n",
       "                           29   5814.0  17236.0  26099.0  122428   \n",
       "                           31   5822.0  17246.0  26123.0  122542   \n",
       "\n",
       "                                    a_team_id  season_year  \n",
       "abbreviation season  Month Day                              \n",
       "ATL          2003-04 01    02      1610612750         2003  \n",
       "                           03      3221225493         4006  \n",
       "                           06      4831838251         6009  \n",
       "                           09      6442450998         8012  \n",
       "                           10      8053063760        10015  \n",
       "...                                       ...          ...  \n",
       "WAS          2017-18 12    23   1977832457752      2468383  \n",
       "                           25   1979443070490      2470400  \n",
       "                           27   1981053683227      2472417  \n",
       "                           29   1982664295972      2474434  \n",
       "                           31   1984274908713      2476451  \n",
       "\n",
       "[37704 rows x 26 columns]"
      ]
     },
     "execution_count": 229,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Need to divide by difference of days\n",
    "games.groupby(['abbreviation', 'season', 'Month','Day']).sum().groupby(level=0).cumsum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 154,
   "id": "multiple-customs",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>game_id</th>\n",
       "      <th>team_id</th>\n",
       "      <th>w</th>\n",
       "      <th>l</th>\n",
       "      <th>w_pct</th>\n",
       "      <th>min</th>\n",
       "      <th>fgm</th>\n",
       "      <th>fga</th>\n",
       "      <th>fg_pct</th>\n",
       "      <th>fg3m</th>\n",
       "      <th>...</th>\n",
       "      <th>dreb</th>\n",
       "      <th>reb</th>\n",
       "      <th>ast</th>\n",
       "      <th>stl</th>\n",
       "      <th>blk</th>\n",
       "      <th>tov</th>\n",
       "      <th>pf</th>\n",
       "      <th>pts</th>\n",
       "      <th>a_team_id</th>\n",
       "      <th>season_year</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>abbreviation</th>\n",
       "      <th>game_date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">ATL</th>\n",
       "      <th>2003-11-02</th>\n",
       "      <td>20300029</td>\n",
       "      <td>1610612737</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.000</td>\n",
       "      <td>265</td>\n",
       "      <td>36.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>0.468</td>\n",
       "      <td>6.0</td>\n",
       "      <td>...</td>\n",
       "      <td>32.0</td>\n",
       "      <td>36</td>\n",
       "      <td>23.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>99</td>\n",
       "      <td>1610612754</td>\n",
       "      <td>2003</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2003-11-09</th>\n",
       "      <td>81200275</td>\n",
       "      <td>6442450948</td>\n",
       "      <td>5.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>0.903</td>\n",
       "      <td>960</td>\n",
       "      <td>133.0</td>\n",
       "      <td>312.0</td>\n",
       "      <td>1.711</td>\n",
       "      <td>19.0</td>\n",
       "      <td>...</td>\n",
       "      <td>127.0</td>\n",
       "      <td>179</td>\n",
       "      <td>76.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>69.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>336</td>\n",
       "      <td>6442451001</td>\n",
       "      <td>8012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2003-11-16</th>\n",
       "      <td>60900339</td>\n",
       "      <td>4831838211</td>\n",
       "      <td>8.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0.883</td>\n",
       "      <td>720</td>\n",
       "      <td>104.0</td>\n",
       "      <td>227.0</td>\n",
       "      <td>1.382</td>\n",
       "      <td>21.0</td>\n",
       "      <td>...</td>\n",
       "      <td>83.0</td>\n",
       "      <td>113</td>\n",
       "      <td>63.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>287</td>\n",
       "      <td>4831838253</td>\n",
       "      <td>6009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2003-11-23</th>\n",
       "      <td>81200633</td>\n",
       "      <td>6442450948</td>\n",
       "      <td>16.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>1.271</td>\n",
       "      <td>960</td>\n",
       "      <td>133.0</td>\n",
       "      <td>319.0</td>\n",
       "      <td>1.666</td>\n",
       "      <td>10.0</td>\n",
       "      <td>...</td>\n",
       "      <td>123.0</td>\n",
       "      <td>173</td>\n",
       "      <td>70.0</td>\n",
       "      <td>33.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>68.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>365</td>\n",
       "      <td>6442451011</td>\n",
       "      <td>8012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2003-11-30</th>\n",
       "      <td>81200828</td>\n",
       "      <td>6442450948</td>\n",
       "      <td>22.0</td>\n",
       "      <td>44.0</td>\n",
       "      <td>1.332</td>\n",
       "      <td>985</td>\n",
       "      <td>138.0</td>\n",
       "      <td>316.0</td>\n",
       "      <td>1.745</td>\n",
       "      <td>15.0</td>\n",
       "      <td>...</td>\n",
       "      <td>130.0</td>\n",
       "      <td>179</td>\n",
       "      <td>84.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>82.0</td>\n",
       "      <td>367</td>\n",
       "      <td>6442451029</td>\n",
       "      <td>8012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">WAS</th>\n",
       "      <th>2018-04-01</th>\n",
       "      <td>86804514</td>\n",
       "      <td>6442451056</td>\n",
       "      <td>166.0</td>\n",
       "      <td>136.0</td>\n",
       "      <td>2.199</td>\n",
       "      <td>960</td>\n",
       "      <td>160.0</td>\n",
       "      <td>343.0</td>\n",
       "      <td>1.869</td>\n",
       "      <td>42.0</td>\n",
       "      <td>...</td>\n",
       "      <td>135.0</td>\n",
       "      <td>174</td>\n",
       "      <td>118.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>81.0</td>\n",
       "      <td>409</td>\n",
       "      <td>6442451031</td>\n",
       "      <td>8068</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-04-08</th>\n",
       "      <td>65103521</td>\n",
       "      <td>4831838292</td>\n",
       "      <td>126.0</td>\n",
       "      <td>111.0</td>\n",
       "      <td>1.595</td>\n",
       "      <td>720</td>\n",
       "      <td>120.0</td>\n",
       "      <td>253.0</td>\n",
       "      <td>1.430</td>\n",
       "      <td>30.0</td>\n",
       "      <td>...</td>\n",
       "      <td>98.0</td>\n",
       "      <td>122</td>\n",
       "      <td>77.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>44.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>316</td>\n",
       "      <td>4831838221</td>\n",
       "      <td>6051</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-04-15</th>\n",
       "      <td>85102538</td>\n",
       "      <td>4831838292</td>\n",
       "      <td>86.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>1.055</td>\n",
       "      <td>720</td>\n",
       "      <td>115.0</td>\n",
       "      <td>264.0</td>\n",
       "      <td>1.318</td>\n",
       "      <td>33.0</td>\n",
       "      <td>...</td>\n",
       "      <td>102.0</td>\n",
       "      <td>136</td>\n",
       "      <td>78.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>45.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>311</td>\n",
       "      <td>4831838252</td>\n",
       "      <td>6051</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-04-22</th>\n",
       "      <td>125100309</td>\n",
       "      <td>4831838292</td>\n",
       "      <td>3.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.833</td>\n",
       "      <td>720</td>\n",
       "      <td>128.0</td>\n",
       "      <td>256.0</td>\n",
       "      <td>1.500</td>\n",
       "      <td>27.0</td>\n",
       "      <td>...</td>\n",
       "      <td>93.0</td>\n",
       "      <td>113</td>\n",
       "      <td>78.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>68.0</td>\n",
       "      <td>347</td>\n",
       "      <td>4831838283</td>\n",
       "      <td>6051</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-04-29</th>\n",
       "      <td>83400211</td>\n",
       "      <td>3221225528</td>\n",
       "      <td>4.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.733</td>\n",
       "      <td>480</td>\n",
       "      <td>69.0</td>\n",
       "      <td>169.0</td>\n",
       "      <td>0.816</td>\n",
       "      <td>13.0</td>\n",
       "      <td>...</td>\n",
       "      <td>67.0</td>\n",
       "      <td>92</td>\n",
       "      <td>33.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>37.0</td>\n",
       "      <td>190</td>\n",
       "      <td>3221225522</td>\n",
       "      <td>4034</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>26239 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                           game_id     team_id      w      l  w_pct  min  \\\n",
       "abbreviation game_date                                                     \n",
       "ATL          2003-11-02   20300029  1610612737    0.0    3.0  0.000  265   \n",
       "             2003-11-09   81200275  6442450948    5.0   17.0  0.903  960   \n",
       "             2003-11-16   60900339  4831838211    8.0   19.0  0.883  720   \n",
       "             2003-11-23   81200633  6442450948   16.0   34.0  1.271  960   \n",
       "             2003-11-30   81200828  6442450948   22.0   44.0  1.332  985   \n",
       "...                            ...         ...    ...    ...    ...  ...   \n",
       "WAS          2018-04-01   86804514  6442451056  166.0  136.0  2.199  960   \n",
       "             2018-04-08   65103521  4831838292  126.0  111.0  1.595  720   \n",
       "             2018-04-15   85102538  4831838292   86.0   78.0  1.055  720   \n",
       "             2018-04-22  125100309  4831838292    3.0    6.0  0.833  720   \n",
       "             2018-04-29   83400211  3221225528    4.0    7.0  0.733  480   \n",
       "\n",
       "                           fgm    fga  fg_pct  fg3m  ...   dreb  reb    ast  \\\n",
       "abbreviation game_date                               ...                      \n",
       "ATL          2003-11-02   36.0   77.0   0.468   6.0  ...   32.0   36   23.0   \n",
       "             2003-11-09  133.0  312.0   1.711  19.0  ...  127.0  179   76.0   \n",
       "             2003-11-16  104.0  227.0   1.382  21.0  ...   83.0  113   63.0   \n",
       "             2003-11-23  133.0  319.0   1.666  10.0  ...  123.0  173   70.0   \n",
       "             2003-11-30  138.0  316.0   1.745  15.0  ...  130.0  179   84.0   \n",
       "...                        ...    ...     ...   ...  ...    ...  ...    ...   \n",
       "WAS          2018-04-01  160.0  343.0   1.869  42.0  ...  135.0  174  118.0   \n",
       "             2018-04-08  120.0  253.0   1.430  30.0  ...   98.0  122   77.0   \n",
       "             2018-04-15  115.0  264.0   1.318  33.0  ...  102.0  136   78.0   \n",
       "             2018-04-22  128.0  256.0   1.500  27.0  ...   93.0  113   78.0   \n",
       "             2018-04-29   69.0  169.0   0.816  13.0  ...   67.0   92   33.0   \n",
       "\n",
       "                          stl   blk   tov    pf  pts   a_team_id  season_year  \n",
       "abbreviation game_date                                                         \n",
       "ATL          2003-11-02   5.0   9.0  16.0  27.0   99  1610612754         2003  \n",
       "             2003-11-09  32.0  25.0  69.0  75.0  336  6442451001         8012  \n",
       "             2003-11-16  19.0  12.0  50.0  65.0  287  4831838253         6009  \n",
       "             2003-11-23  33.0  29.0  68.0  90.0  365  6442451011         8012  \n",
       "             2003-11-30  29.0  22.0  59.0  82.0  367  6442451029         8012  \n",
       "...                       ...   ...   ...   ...  ...         ...          ...  \n",
       "WAS          2018-04-01  30.0  21.0  59.0  81.0  409  6442451031         8068  \n",
       "             2018-04-08  22.0  12.0  44.0  59.0  316  4831838221         6051  \n",
       "             2018-04-15  24.0   7.0  45.0  70.0  311  4831838252         6051  \n",
       "             2018-04-22  27.0  19.0  32.0  68.0  347  4831838283         6051  \n",
       "             2018-04-29   9.0   9.0  29.0  37.0  190  3221225522         4034  \n",
       "\n",
       "[26239 rows x 26 columns]"
      ]
     },
     "execution_count": 154,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "games"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "driving-chaos",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
